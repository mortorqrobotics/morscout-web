<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>MorScout</title>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:700,300,400' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Exo+2:100' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/index.css" type="text/css">
    <link rel="stylesheet" href="css/form.css" type="text/css">
    <link rel="stylesheet" href="css/login.css" type="text/css">
    <link rel="stylesheet" href="css/welcome_page.css" type="text/css">
    <link rel="stylesheet" href="css/feedback.css" type="text/css">
    <link rel="stylesheet" href="css/welcome_page.css" type="text/css">
    <link rel="stylesheet" href="css/report_screen.css" type="text/css">
    <link rel="stylesheet" href="css/welcome_page.css" type="text/css">
    <link rel="stylesheet" href="css/sync.css" type="text/css">
</head>

<body>

    <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container-fluid">
            <div class="navbar-header">
                <a class="navbar-brand" id="morscout" href="index.html">MorScout</a>
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#MorScoutNav" id="toggle_button">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
            </div>
            <div class="collapse navbar-collapse" id="MorScoutNav">
                <ul class="nav navbar-nav">
                    <li><a href="matches.html" title="List of all matches">All Matches</a></li>
                    <li><a href="teams.html" title="List of all teams">Team List</a></li>
                    <li><a href="sync.html" title="Sync with the server">Sync</a></li>
                    <li><a href="settings.html" title="Configure the settings">Settings</a></li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="help.html" title="Need help?">Help</a></li>
                    <li><a href="feedback.html" title="Give team 1515 your feedback!">Feedback</a></li>
                    <li id="UserDropdown" class="dropdown">
                        <a id="logoutButton" href="login.html">Log in</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>


    <div class="formbutton">
        <input type="button" class="formmakerbutton" id="formbutton" value="Add Data Point">
    </div>

    <div class="submitbutton">
        <input type="button" id="submitformbutton" value="Submit Form">
    </div>

    <div class="formcreator">
        <div class="container">
            <div class="row" id="form-holder">
                <h2>Create Scouting Form</h2>
                <br>
                <!-- <select required class='creator_dropdown'>
           <option value='text'>Text Box</option>
           <option value='dropdown'>Dropdown List</option>
           <option value='radio'>Radio Button</option>
           <option value='label'>Label</option>
           <option value='number'>Number Box</option>
           <option value='check'>Check Box</option>
         </select>
         <input type="text" class="dp-box" id="data_point_name" placeholder="Data Point Name" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Data Point Name'"><br>
         <div id="form_options">
      </div> -->
                <!--  <br>
      <select required class='creator_dropdown'>
        <option value='text'>Text Box</option>
        <option value='dropdown'>Dropdown List</option>
        <option value='radio'>Radio Button</option>
        <option value='label'>Label</option>
        <option value='number'>Number Box</option>
        <option value='check'>Check Box</option>
      </select>
      <input type="text" class="dp-box" id="data_point_name" placeholder="Data Point Name" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Data Point Name'"><br>
      <div id="form_options">
   </div> -->



            </div>
            <h2>Form Preview</h2>
            <div class="row" id="form-preview">

            </div>


            <!-- <div id="submit-form">
             <input type="button" id="submit-form-button" value="Submit Form">
     </div> -->

            <!-- JAVASCRIPT -->
            <script src="js/jquery-2.1.3.min.js"></script>
            <script src="js/bootstrap.min.js"></script>
            <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/2.2.1/isotope.pkgd.min.js"></script> -->
            <script src="js/main.js" type="text/javascript"></script>

            <script>
                function createNewDataPoint() {
                    var divWrapper = $(document.createElement("div"));
                    divWrapper.addClass("dp-wrapper");
                    var wrappers = $("#form-holder").find(".dp-wrapper");
                    var dpNum = "1";
                    if (wrappers.length != 0) {
                        dpNum = parseInt($(wrappers[wrappers.length - 1]).attr("data-id")) + 1 + "";
                    }
                    divWrapper.attr("data-id", dpNum);
                    var select = $(document.createElement("select"));
                    select.addClass("creator_dropdown");
                    select.attr("required", "true");
                    var options = [{
                        value: "text",
                        name: "Text Box"
                    }, {
                        value: "dropdown",
                        name: "Dropdown List"
                    }, {
                        value: "radio",
                        name: "Radio Button"
                    }, {
                        value: "label",
                        name: "Label"
                    }, {
                        value: "number",
                        name: "Number Box"
                    }, {
                        value: "check",
                        name: "Check Box"
                    }];
                    for (var i = 0; i < options.length; i++) {
                        var option = $(document.createElement("option"));
                        option.attr("value", options[i].value);
                        option.html(options[i].name);
                        select.append(option);
                    }
                    var input = $(document.createElement("input"));
                    input.attr("type", "text");
                    input.addClass("dp-box data_point_name");
                    input.attr("placeholder", "Data Point Name");
                    var span = $(document.createElement("span"));
                    span.addClass("glyphicon glyphicon-remove remove_dp btn-lg");
                    var div = $(document.createElement("div"));
                    div.addClass("form_options");
                    span.attr("data-id", dpNum);
                    select.attr("data-id", dpNum);
                    input.attr("data-id", dpNum);
                    div.attr("data-id", dpNum);
                    divWrapper.append(select);
                    divWrapper.append(input);
                    divWrapper.append(span);
                    divWrapper.append(div);
                    $("#form-holder").append(divWrapper);
                }
                createNewDataPoint();

                $("#formbutton").on("click", function() {
                    createNewDataPoint();
                });

                function synthesizeForm(dataPoints) {
                    $('#form-preview').empty();
                    for (var i = 0; i < dataPoints.length; i++) {
                        var dataPoint = dataPoints[i];
                        var dpName = dataPoint.name;
                        var dpType = dataPoint.type;
                        if (dpType == "radio") {
                            // <div class="radio">
                            // ass="report_check" type="radio" name="auto" id="nearDrivers"></input>
                            // ="report_text" for="nearDrivers" class="report_radio_check">Started near drivers</label><br/>
        					// 	<input class="report_check" type="radio" name="auto" id="radio12"></input>
        					// 	<label id="report_text" for="radio12" class="report_radio_check">Started near landfill</label><br/>
        					// </div>
                            var options = dataPoint.options;
                            var div = $(document.createElement("div"));
                            div.addClass("radio");
                            for (var j = 0; j < options.length; j++) {
                                var option = options[j];
                                var input = $(document.createElement("input"));
                                input.attr("type", "radio");
                                input.attr("name", dpName);//FIX
                                input.attr("id", option)
                                input.addClass("report_check");
                                var label = $(document.createElement("label"));
                                label.addClass("report_text report_radio_check");
                                label.attr("for", option);
                                label.html(option);
                                div.append(input);
                                div.append(label);
                                div.append("<br/>");
                            }
                            console.log($("input[name='1']").val())
                            $('#form-preview').append(div);

                        } else if (dpType == "dropdown") {
                            var options = dataPoint.options;
                            var select = $(document.createElement("select"));
                            select.addClass("creator_dropdown");
                            for (var j = 0; j < options.length; j++) {
                                var optionText = options[j];
                                var option = $(document.createElement("option"));
                                option.html(optionText);
                                select.append(option);
                            }
                            var p = $(document.createElement("p"));
                            p.addClass("report_text");
                            p.html(dpName);

                            $('#form-preview').append(p);
                            $('#form-preview').append(select);
                        } else if (dpType == "number") {
                            var start = dataPoint.start;
                            var min = dataPoint.min;
                            var max = dataPoint.max;
                            //<h3 class="scout_div_title">Autonomous</h3>
                            //<input type="button" id="grayTotesMinus" class="button add_minus_button" value="-"></input>
                            //<input class="grayTotes" id="report_box_small" type="number" value="0"></input>
                            //<input type="button" id="grayTotesPlus" class="button add_minus_button" value="+"></input><br/>

                            var p = $(document.createElement("p"));
                            p.addClass("report_text");
                            p.html(dpName);

                            var inputAdd = $(document.createElement("input"));
                            inputAdd.attr("type", "button");
                            inputAdd.addClass("button add_minus_button");
                            inputAdd.val("+");

                            var inputButton = $(document.createElement("input"));
                            inputButton.attr("type", "number");
                            inputButton.addClass("report_box_small");
                            inputButton.attr("min", min);
                            inputButton.attr("max", max);
                            inputButton.val(start)

                            var inputSubtract = $(document.createElement("input"));
                            inputSubtract.attr("type", "button");
                            inputSubtract.addClass("button add_minus_button");
                            inputSubtract.val("-");

                            $('#form-preview').append(p);
                            $('#form-preview').append(inputAdd);
                            $('#form-preview').append(inputButton);
                            $('#form-preview').append(inputSubtract);
                        } else if (dpType == "check") {
                            //var input = ;

                            $('#form-preview').append();
                        } else if (dpType == "label") {
                            var label = dataPoint.label;

                            $('#form-preview').append(label);
                        } else if (dpType == "text") {
                            //  var text = ;

                            $('#form-preview').append(text);
                        }
                        $('#form-preview').append("</br>");
                    }
                }

                function createDropdownInput(textboxHolder) {
                    var input = $(document.createElement("input"));
                    input.attr("type", "text");
                    input.attr("placeholder", "Option");
                    input.addClass("option-box");
                    textboxHolder.append(input);
                    var added = false;
                    input.keyup(function() {
                        if ($.trim(input.val()) != "") {
                            if (!added) {
                                createDropdownInput(textboxHolder);
                                added = true;
                            }
                        } else if (added) {
                            input.remove();
                        }
                    });
                }

                $(document).on("click", ".remove_dp", function() {
                    var id = $(this).attr("data-id");
                    $(".dp-wrapper[data-id='" + id + "']").hide('slow', function() {
                        $(".dp-wrapper[data-id='" + id + "']").remove();
                    });
                });

                $("#submitformbutton").on("click", function() {
                    var wrappers = $("#form-holder").find(".dp-wrapper");
                    var dataPoints = [];
                    var pointsValid = true;
                    for (var i = 0; i < wrappers.length; i++) {
                        var dp = $(wrappers[i]);
                        var dataPointInfo = {};
                        var dpType = dp.find(".creator_dropdown").eq(0).val();
                        var dpName = dp.find(".data_point_name").eq(0).val();
                        if ($.trim(dpName) != "" && $.trim(dpType) != "") {
                            dataPointInfo.name = dpName;
                            dataPointInfo.type = dpType;
                            if (dpType == "radio" || dpType == "dropdown") {
                                var options = [];
                                var optionBoxes = dp.find(".option-box");
                                for (var j = 0; j < optionBoxes.length; j++) {
                                    var box = $(optionBoxes[j]);
                                    if ($.trim(box.val()) != "") {
                                        options.push(box.val());
                                    }
                                }
                                dataPointInfo.options = options;
                            } else if (dpType == "number") {
                                var start = dp.find(".start-box").eq(0).val();
                                var min = dp.find(".min-box").eq(0).val();
                                var max = dp.find(".max-box").eq(0).val();
                                if (areNumbers([start, min, max])) {
                                    dataPointInfo.start = parseInt(start);
                                    dataPointInfo.min = parseInt(min);
                                    dataPointInfo.max = parseInt(max);
                                } else {
                                    pointsValid = false;
                                    break;
                                }
                            } else {
                                //use later?
                            }
                            dataPoints.push(dataPointInfo);
                        } else {
                            pointsValid = false;
                            break;
                        }
                    }
                    if (pointsValid) {
                        alert("Success");
                        synthesizeForm(dataPoints);
                        //dataPoints is an array of all information
                    } else {
                        alert("Field missing or invalid input");
                    }
                });

                $(document).on("change", ".creator_dropdown", function() {
                    var id = $(this).attr("data-id");
                    var options = $(".form_options[data-id='" + id + "']");
                    options.empty();
                    var type = $(this).val();
                    if (type == "radio" || type == "dropdown") {
                        createDropdownInput(options);
                    } else if (type == "number") {
                        var input = $(document.createElement("input"));
                        input.attr("type", "number");
                        input.attr("placeholder", "start");
                        input.addClass('start-box');
                        options.append(input);

                        var input = $(document.createElement("input"));
                        input.attr("type", "number");
                        input.attr("placeholder", "min");
                        input.addClass('min-box');
                        options.append(input);

                        var input = $(document.createElement("input"));
                        input.attr("type", "number");
                        input.attr("placeholder", "max");
                        input.addClass('max-box');
                        options.append(input);
                    } else {
                        //use later?
                    }


                });
            </script>

</body>

</html>
